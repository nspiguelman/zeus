<html xmlns="http://www.w3.org/1999/html">
<head>
    <title>Melody example: chatting</title>
</head>

<style>
    #chat {
        text-align: left;
        background: #f1f1f1;
        width: 500px;
        min-height: 300px;
        padding: 20px;
    }
</style>

<body>
<center>
    <h3 id="name"></h3>
    <pre id="chat"></pre>
    <input placeholder="say something" id="text" type="text">
    <button onClick="sendMessage();">Enviar </button>
</center>

<script>
    var url = "ws://localhost:8080/room/AAA/question/BB/user/nahue/ws";
    var ws = new WebSocket(url);
    var name = "Guest" + Math.floor(Math.random() * 1000);
    var channelName = window.location.pathname.split("/")[2];

    document.getElementById("name").innerText = "Channel: " + channelName;

    var chat = document.getElementById("chat");
    var text = document.getElementById("text");

    var now = function () {
        var iso = new Date().toISOString();
        return iso.split("T")[1].split(".")[0];
    };

    ws.onmessage = function (msg) {
        console.log("el servidor mando algo")
        var line =  now() + " " + msg.data + "\n";
        chat.innerText += line;
    };

    function sendMessage(){
        ws.send("TOKEN;QUESTIONID;" + text.value);

    }

</script>
</body>
</html>